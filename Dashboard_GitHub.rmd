---
title: "Estatística ENADE 2017 - Engenharia Civil (5710)"
author: "Construção de dashboards"
date: "31 de outubro de 2023"
output: 
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bootswatch:
      bg: white
      fg: black
      primary: "#ED79F9"
      navbar-bg: "#3ADAC6"
      base_font:
        google: Sen
      code_font:
        google: JetBrains Mono
    orientation: columns
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(stringr)
library(lubridate)
library(plotly)
library(ggplot2)
library(dplyr)
library(kableExtra)


dados_filtrados <- read.csv("dados_filtrados_5710_engenharia_civil.csv", header = TRUE, sep = ",")

media_curso <- mean (dados_filtrados$NT_OBJ_FG)

```

# Estatística do Curso

Aqui trazemos os dados de média, mediana, desvio padrão, mínimo e máximo das notas do curso de Engenharia Civil no ENADE de 2017 (tabela à esquerda), bem como o histograma das notas (gáfico à direita). Nas próximas páginas temos os mesmos dados discriminados por raça, região e turno do curso.

## \## Columns

### Estatística descritiva Curso de Engenharia Civil

```{r}
estatisticas_curso <- dados_filtrados %>%
    summarise(
        Quantidade = n(),
        Media = mean(NT_OBJ_FG, na.rm = TRUE),
        Mediana = median(NT_OBJ_FG, na.rm = TRUE),Media = mean(NT_OBJ_FG, na.rm = TRUE),
        Desvio_Padrao = sd(NT_OBJ_FG, na.rm = TRUE),
        Minimo = min(NT_OBJ_FG, na.rm = TRUE),
        Maximo = max(NT_OBJ_FG, na.rm = TRUE)
    ) %>%
  kable("html") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, bold = TRUE)
estatisticas_curso
```

## \## Columns

### Histograma de notas objetivas - Curso de Engenharia Civil 2017

```{r}
ggplot(data = dados_filtrados, aes(x = NT_OBJ_FG)) +
  geom_histogram(color = "white", fill = "blue", bins = 9)+
  scale_x_continuous(breaks = seq(0, 100, by = 10), labels = seq(0, 100, by = 10)) +
  labs(title = "Histograma: Overview Notas Engenharia Civil", x = "Notas", y = "Frequência") 

```

# Estatística por Raça


## Columns

### Estatística descritiva por Raça

```{r}
estatisticas_raca <- dados_filtrados %>%
  group_by(QE_I02) %>%
  summarise(
    Quantidade = n(),
    Media = mean(NT_OBJ_FG, na.rm = TRUE),
    Mediana = median(NT_OBJ_FG, na.rm = TRUE),
    Desvio_Padrao = sd(NT_OBJ_FG, na.rm = TRUE),
    Minimo = min(NT_OBJ_FG, na.rm = TRUE),
    Maximo = max(NT_OBJ_FG, na.rm = TRUE)
  ) %>%
  kable("html") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, bold = TRUE)
estatisticas_raca
```

Média Geral das notas do curso de Engenharia Civil:

55.2 (representada pela linha vermelha tracejada no gráfico)

## \## Columns

### Gráfico de notas por Raça

```{r}
ggplot(dados_filtrados, aes(x = QE_I02, y = NT_OBJ_FG, fill = QE_I02 )) +
  geom_boxplot() +
  labs(title = "Boxplot: Notas por Raça", x = "Raça", y = "Notas") + geom_hline(yintercept=media_curso, color="red", linetype="dashed")
```

# Estatística por Região

## \## Columns

### Estatística descritiva por Região

```{r}
estatisticas_regiao <- dados_filtrados %>%
  group_by(CO_REGIAO_CURSO) %>%
  summarise(
    Quantidade = n(),
    Media = mean(NT_OBJ_FG, na.rm = TRUE),
    Mediana = median(NT_OBJ_FG, na.rm = TRUE),
    Desvio_Padrao = sd(NT_OBJ_FG, na.rm = TRUE),
    Minimo = min(NT_OBJ_FG, na.rm = TRUE),
    Maximo = max(NT_OBJ_FG, na.rm = TRUE)
  ) %>%
  kable("html") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, bold = TRUE)
estatisticas_regiao
```

Média Geral das notas do curso de Engenharia Civil:

55.2 (representada pela linha vermelha tracejada no gráfico)

## \## Columns

### Gráfico de notas por Região

```{r}
ggplot(dados_filtrados, aes(x = CO_REGIAO_CURSO, y = NT_OBJ_FG, 
                            fill = CO_REGIAO_CURSO )) +
  geom_boxplot() +
  labs(title = "Boxplot: Notas por Região", x = "Região", y = "Notas") + geom_hline(yintercept=media_curso, color="red", linetype="dashed")
```

# Estatística por Turno

## Columns

### Estatística descritiva por Turno

```{r}
estatisticas_turno <- dados_filtrados %>%
  group_by(CO_TURNO_GRADUACAO) %>%
  summarise(
    Quantidade = n(),
    Media = mean(NT_OBJ_FG, na.rm = TRUE),
    Mediana = median(NT_OBJ_FG, na.rm = TRUE),
    Desvio_Padrao = sd(NT_OBJ_FG, na.rm = TRUE),
    Minimo = min(NT_OBJ_FG, na.rm = TRUE),
    Maximo = max(NT_OBJ_FG, na.rm = TRUE)
  ) %>%
  kable("html") %>%
  kable_styling(full_width = FALSE) %>%
  column_spec(1, bold = TRUE)
estatisticas_turno
```

Média Geral das notas do curso de Engenharia Civil:

55.2 (representada pela linha vermelha tracejada no gráfico)

## Columns

## Gráfico de notas por Turno

```{r}
ggplot(dados_filtrados, aes(x = CO_TURNO_GRADUACAO, y = NT_OBJ_FG, 
                            fill = CO_TURNO_GRADUACAO )) +
  geom_boxplot() +
  labs(title = "Boxplot: Notas por Turno", x = "Turno", y = "Notas") + geom_hline(yintercept=media_curso, color="red", linetype="dashed")
```
